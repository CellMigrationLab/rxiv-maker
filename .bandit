# Bandit configuration for rxiv-maker security scanning

[bandit]
# Paths to exclude from scanning
exclude_dirs = [
    "tests",
    "docs",
    "build",
    "dist",
    ".git",
    "__pycache__",
    ".pytest_cache",
    ".mypy_cache",
    "node_modules"
]

# Tests to skip (if any specific tests are problematic)
skips = [
    # Skip subprocess shell=True warnings in platform detection code where it's safe
    "B602",  # subprocess_popen_with_shell_equals_true - used safely in platform.py
    # Skip pickle warnings for internal caching (trusted data only)
    "B301",  # pickle usage in advanced_cache.py for internal data only
    "B403",  # pickle import - used only for internal caching
    # Skip standard library warnings for legitimate usage
    "B404",  # subprocess import - required for system integration
    "B603",  # subprocess calls - validated input
    "B311",  # pseudo-random generators - used for non-security purposes
    "B110",  # try/except pass - acceptable for error handling
    "B310",  # URL handling - controlled input
    "B607",  # partial executable paths - controlled environment
]

# Confidence levels: LOW, MEDIUM, HIGH
confidence = "MEDIUM"

# Security issue levels: LOW, MEDIUM, HIGH
level = "LOW"

# Output format options: csv, custom, html, json, screen, txt, xml, yaml
format = "screen"

# Show only issues with confidence level >= specified
min_confidence_level = "MEDIUM"

# Additional options
verbose = true
quiet = false
