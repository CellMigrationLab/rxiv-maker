# =====================================
# Article-Forge Docker Build Configuration
# =====================================

# Build arguments for optimization
ARG BUILDKIT_INLINE_CACHE=1
ARG PYTHON_VERSION=3.11
ARG DEBIAN_VERSION=bookworm-slim
ARG NODE_VERSION=18

# Multi-platform support
ARG TARGETPLATFORM
ARG BUILDPLATFORM

# =====================================
# Build Performance Settings
# =====================================

# Enable BuildKit features
# syntax=docker/dockerfile:1.4

# Use cache mounts for package managers
# --mount=type=cache,target=/var/cache/apt
# --mount=type=cache,target=/root/.cache/pip
# --mount=type=cache,target=/root/.npm

# =====================================
# Security Settings
# =====================================

# Non-root user configuration
ARG USER_ID=1000
ARG GROUP_ID=1000
ARG USERNAME=appuser

# =====================================
# Application Settings
# =====================================

# Python optimization
ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1
ENV PIP_NO_CACHE_DIR=1
ENV PIP_DISABLE_PIP_VERSION_CHECK=1

# LaTeX optimization
ENV TEXMFCACHE=/tmp/texmf-cache
ENV OPENTYPE_FONTS=/usr/share/fonts/opentype

# Node.js optimization
ENV NODE_ENV=production
ENV NPM_CONFIG_CACHE=/tmp/.npm
ENV NPM_CONFIG_UPDATE_NOTIFIER=false
